for(i in 1:30){
if(i<=10){
names[i]<-"A"
}else if(i>10&&i<=20){
names[i]<-"B"
}else{
names[i]<-"C"
}
}
p<-numeric(20)
count=0
for(i in 1:20){
r <- rnorm(30)
for(j in 1:10){
r[j]=r[j]+2
}
aov.model <- aov(r ~ names)
x<-summary(aov.model)[[1]][["Pr(>F)"]][[1]]
x=round(x,2)
p[i]<-x
if(x<0.1){
count=count+1
}
}
boxplot(p,ylim = c(0, 1))
print(c("reject count", count, "p-avg", sum(p)/20))
names<-character(30)
for(i in 1:30){
if(i<=10){
names[i]<-"A"
}else if(i>10&&i<=20){
names[i]<-"B"
}else{
names[i]<-"C"
}
}
p<-numeric(20)
count=0
for(i in 1:20){
r <- rnorm(30)
for(j in 1:10){
r[j]=r[j]+2
}
aov.model <- aov(r ~ names)
x<-summary(aov.model)[[1]][["Pr(>F)"]][[1]]
x=round(x,2)
p[i]<-x
if(x<0.1){
count=count+1
}
}
boxplot(p,ylim = c(0, 1))
print(c("reject count", count, "p-avg", sum(p)/20))
names<-character(30)
for(i in 1:30){
if(i<=10){
names[i]<-"A"
}else if(i>10&&i<=20){
names[i]<-"B"
}else{
names[i]<-"C"
}
}
p<-numeric(20)
count=0
for(i in 1:20){
r <- rnorm(30)
for(j in 1:10){
r[j]=r[j]+2
}
aov.model <- aov(r ~ names)
x<-summary(aov.model)[[1]][["Pr(>F)"]][[1]]
x=round(x,2)
p[i]<-x
if(x<0.1){
count=count+1
}
}
boxplot(p,ylim = c(0, 1))
print(c("reject count", count, "p-avg", sum(p)/20))
names<-character(30)
for(i in 1:30){
if(i<=10){
names[i]<-"A"
}else if(i>10&&i<=20){
names[i]<-"B"
}else{
names[i]<-"C"
}
}
p<-numeric(20)
count=0
for(i in 1:20){
r <- rnorm(30)
for(j in 1:10){
r[j]=r[j]+2
}
aov.model <- aov(r ~ names)
x<-summary(aov.model)[[1]][["Pr(>F)"]][[1]]
x=round(x,2)
p[i]<-x
if(x<0.1){
count=count+1
}
}
boxplot(p,ylim = c(0, 1))
print(c("reject count", count, "p-avg", sum(p)/20))
help(pf)
pf(93.161/0.021,1,1)
pf(8.251/0.021,1,1)
93.161/0.021
8.251/0.021
data
data<-read.table("./data/asthma.txt")
data
# question 5
data<-read.table("./data/asthma.txt", header=TRUE)
pwd
setwd("~/cs-home/python-scraping/r-stats")
# question 5
data<-read.table("./data/asthma.txt", header=TRUE)
# question 5
data<-read.table("./hwdata/asthma.txt", header=TRUE)
# question 5
data<-read.table("./hwdata/asthma.txt", header=TRUE)
asthma<-read.table("ã€‚/hwdata/asthma.txt",header = T)
attach(asthma)
gfit<-lm(resistance~height)
summary(gfit)
plot(gfit)
asthma<-read.table("./hwdata/asthma.txt",header = T)
attach(asthma)
gfit<-lm(resistance~height)
summary(gfit)
plot(gfit)
gfit<-lm(resistance~X.height)
# question 5
asthma<-read.table("./hwdata/asthma.txt",header = T)
attach(asthma)
gfit<-lm(resistance~height)
summary(gfit)
plot(gfit)
# question 5
asthma<-read.table("./hwdata/asthma.txt",header = T)
attach(asthma)
gfit<-lm(resistance~height)
summary(gfit)
plot(gfit)
0.0531+qt(0.025,40)*0.0531
qt(0.025,40)
0.0531-qt(0.025,40)*0.0531
-0.1361-qt(0.025,40)*0.0531
-0.1361+qt(0.025,40)*0.0531
27.5157+qt(0.025,40)*4.146
27.5157-qt(0.025,40)*4.146
plot(asthma)
SSI<-2.074
SSD<-15.588
SSIn<-0.810
SSE<-35.296
SST<-53.768
print(SST-SSD)
SSI<-2.074
SSD<-15.588
SSIn<-0.810
SSE<-35.296
SST<-53.768
J<-2
I<-3
SSW<-SST-SSD
print((SSB/(J-1))/(SSW/(J*(J*k-1))))
SSI<-2.074
SSD<-15.588
SSIn<-0.810
SSE<-35.296
SST<-53.768
J<-2
I<-3
SSW<-SST-SSD
print((SSD/(J-1))/(SSW/(J*(J*k-1))))
SSI<-2.074
SSD<-15.588
SSIn<-0.810
SSE<-35.296
SST<-53.768
J<-2
I<-3
K<-18
SSW<-SST-SSD
print((SSD/(J-1))/(SSW/(J*(J*k-1))))
print((SSD/(J-1))/(SSW/(J*(J*K-1))))
SSI<-2.074
SSD<-15.588
SSIn<-0.810
SSE<-35.296
SST<-53.768
J<-2
I<-3
K<-18
SSW<-SST-SSD
MS1<-7.794
MS2<-SSW/(J*(J*K-1))
print(c(MS1,MS2))
print(38.18/105)
print(7.794/(38.18/105))
pf(21.435,2,105)
pf(22.53,2,105)
p1<-pf(21.435,2,105, lower.tail=FALSE)
p2<-pf(22.53,2,102, lower.tail=FALSE)
print(p1/p2)
93.161/196/972
93.161/196.972
196.972/45
93.161/4.377156
8.251/4.377
pf(1.885,1,45,lower.tail = FALSE)
pf(21.283,1,45,lower.tail = FALSE)
27.5195-2.02*6.6363
27.5195+2.02*6.6363
summary(gfit)
plot(asthma$height, gfit$residuals)
qqnorm(gfit$residuals)
data<-read.csv('hw7-provingring.txt')
data<-read.csv('./hwdata/hw7-provingring.txt')
data<-read.csv('./hwdata/hw7-provingring.txt')
View(data)
data<-read.csv('./hwdata/hw7-provingring.txt', '\t')
data<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
# question 5
asthma<-read.table("./hwdata/asthma.txt",header = T)
X.Load.
X.Load
lm1<-lm(ring$Load~ring$Deflection)
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
lm1<-lm(ring$Load~ring$Deflection)
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
lm1<-lm(ring$X.Load.~ring$X.Deflection.)
plot(ring$X.Load.~ring$X.Deflection.)
summary(lm1)
lm1
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
lm1<-lm(ring$X.Load.~ring$X.Deflection.+(ring$X.Deflection.)^2)
plot(ring$X.Load.~ring$X.Deflection.)
summary(lm1)
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
b1<-ring$X.Deflection
b2<-(ring$X.Deflection.)^2
lm1<-lm(ring$X.Load.~b1+b2)
plot(ring$X.Load.~ring$X.Deflection.)
summary(lm1)
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
y<-ring$X.Load.
x<-ring$X.Deflection.
x_sqr<-(ring$X.Deflection.)^2
lm1<-lm(y~x+x_sqr)
plot(y,x)
lines(x, lm1$coefficients[1] + x*lm1$coefficients[2] + x*x*lm1$coefficients[3], col="green")
summary(lm1)
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
y<-ring$X.Load.
x<-ring$X.Deflection.
x_sqr<-(ring$X.Deflection.)^2
lm1<-lm(y~x+x_sqr)
plot(x,y)
lines(x, lm1$coefficients[1] + x*lm1$coefficients[2] + x*x*lm1$coefficients[3], col="green")
summary(lm1)
plot(lm1$residuals)
plot(x, lm1$residuals)
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
y<-ring$X.Load.
x<-ring$X.Deflection.
x_sqr<-(ring$X.Deflection.)^2
lm1<-lm(y~x+x_sqr)
plot(x,y)
lines(x, lm1$coefficients[1] + x*lm1$coefficients[2] + x*x*lm1$coefficients[3], col="green")
lm2<-lm(y~x)
plot(x, lm2$residuals)
plot(x,y, xlim=c(0,100000), ylim=c(0,100000))
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
y<-ring$X.Load.
x<-ring$X.Deflection.
x_sqr<-(ring$X.Deflection.)^2
lm1<-lm(y~x+x_sqr)
plot(x,y, xlim=c(0,100000), ylim=c(0,100000))
lines(x, lm1$coefficients[1] + x*lm1$coefficients[2] + x*x*lm1$coefficients[3], col="green")
lm2<-lm(y~x)
plot(x, lm2$residuals)
plot(x,y, xlim=c(0,100000), ylim=c(0,100000))
plot(x,y/100, xlim=c(0,1000), ylim=c(0,1000))
plot(x,y/100, xlim=c(0,700), ylim=c(0,1000))
# question 4 (Rice 14-40)
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
y<-ring$X.Load.
x<-ring$X.Deflection.
x_sqr<-(ring$X.Deflection.)^2
lm1<-lm(y~x)
plot(x,y/100, xlim=c(0,700), ylim=c(0,1000))
lines(x)
lines(x, lm1$coefficients[1] + x*lm1$coefficients[2], col="blue")
# question 4 (Rice 14-40)
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
y<-ring$X.Load.
x<-ring$X.Deflection.
x_sqr<-(ring$X.Deflection.)^2
lm1<-lm(y~x)
plot(x,y)
lines(x)
lines(x, lm1$coefficients[1] + x*lm1$coefficients[2], col="blue")
plot(x, lm1$residuals)
qqplot(x,y)
plot(lm1)
lm2<-lm(y~x+x_sqr)
lines(x, lm2$coefficients[1] + x*lm2$coefficients[2] + x*x*lm2$coefficients[3], col="blue")
plot(lm2)
summary(lm2)
plot(x,lm2$fitted.values)
plot(x,y)
lines(x, lm2$coefficients[1] + x*lm2$coefficients[2] + x*x*lm2$coefficients[3], col="blue")
lines(x, lm2$fitted.values, col="green")
plot(x,lm2$residuals)
plot(lm2)
# Question 3 (Rice 14-39)
tank<-read.csv("./hwdata/hw7-tankvolume.txt", header=T, sep='\t')
# Question 3 (Rice 14-39)
tank<-read.csv("./hwdata/hw7-tankvolume.txt", header=T, sep='\t')
volume<-tank$X.Volume.
pressure<-tank$X.Pressure.
plot(pressure, volume)
# Question 3 (Rice 14-39)
tank<-read.csv("./hwdata/hw7-tankvolume.txt", header=T, sep='\t')
volume<-tank$X.Volume.
pressure<-tank$X.Pressure.
plot(volume,pressure)
lm_tank<-lm(pressure~volume)
summary(lm_tank)
lines(volume, lm_tank$fitted.values)
plot(volume, lm_tank$residuals)
lm_tank_quadratic(pressure~volume)
summary(lm_tank_quadratic)
plot(volume,lm_tank_quadratic$fitted.values)
lm_tank_quadratic<-lm(pressure~volume)
summary(lm_tank_quadratic)
plot(volume,lm_tank_quadratic$fitted.values)
lm_tank_quadratic<-lm(pressure~volume+volume^2)
summary(lm_tank_quadratic)
volume_sqr<-volume^2
lm_tank_quadratic<-lm(pressure~volume+volume_sqr)
summary(lm_tank_quadratic)
plot(volume,lm_tank_quadratic$fitted.values)
plot(volume, lm_tank_sqr$residuals)
plot(volume, lm_tank_quadratic$residuals)
plot(volume,pressure)
lines(volume, lm_tank_quadratic$fitted.values)
lines(volume, lm_tank_quadratic$fitted.values, col="green")
# Question 5: two data sets
cy<-read.csv("./hwdata/hw7-cystfibr.txt", header=T, sep='\t')
as<-read.csv("./hwdata/asthma.txt", header=T, sep='\t') # 24 rows
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
load<-ring$X.Load.
deflect<-ring$X.Deflection.
load_sqr<-load^2
lm1<-lm(deflect~load)
plot(load,deflect)
lines(load, lm1$coefficients[1] + x*lm1$coefficients[2], col="blue")
lines(load, lm1$coefficients[1] + load*lm1$coefficients[2], col="blue")
# quadratic
lm2<-lm(y~load+load_sqr)
plot(load,deflect)
lines(load, lm2$fitted.values, col="green")
plot(load,lm2$residuals)
# quadratic
lm2<-lm(deflect~load+load_sqr)
plot(load,deflect)
lines(load, lm2$fitted.values, col="green")
plot(load,lm2$residuals)
plot(lm2)
plot(load,lm2$residuals)
summary(lm2)
abline(0,0)
as_1<-as$height
z<-rep(0,42)
z<-c(rep(0,42), rep(1,24)
z
z<-c(rep(0,42), rep(1,24))
z
# Question 5: two data sets
as<-read.csv("./hwdata/asthma.txt", header=T, sep='\t') # 42 rows
cy<-read.csv("./hwdata/hw7-cystfibr.txt", header=T, sep='\t') # 24 rows
height<-c(as$height, cy$X.height.)
height_times_z<-height*z
lm5<-lm(resist ~ height + z + height_times_z)
# Question 5: two data sets
as<-read.csv("./hwdata/asthma.txt", header=T, sep='\t') # 42 rows
cy<-read.csv("./hwdata/hw7-cystfibr.txt", header=T, sep='\t') # 24 rows
z<-c(rep(0,42), rep(1,24))
height<-c(as$height, cy$X.height.)
resist<-c(as$resistance, cy$X.resistance.)
height_times_z<-height*z
lm5<-lm(resist ~ height + z + height_times_z)
summary(lm5)
## F-test between two models
lm5_small<-lm(resist ~ height)
anova(lm_small, lm5)
anova(lm5_small, lm5)
summary(lm5_small)
4.165^2*64
anova(lm5, lm5_small)
plot(lm5$residuals)
plot(height, lm5$residuals)
plot(lm5$fitted.values, lm5$residuals)
help(I)
summary(lm5)
# Four t-test
lm5<-lm(resist ~ height + z + I(height*z))
summary(lm5)
# Four t-test
lm5<-lm(resist ~ height + z + height*z)
summary(lm5)
# Four t-test
lm5<-lm(resist ~ height + z + I(height*z))
summary(lm5)
lm6_1<-lm(deflect ~ load + I(load^2) + I(load^3) + I(load^4))
deflect<-ring$X.Deflection.
# Question 6: Quadratic model
ring<-read.csv("./hwdata/hw7-provingring.txt", header=TRUE, sep = "\t")
load<-ring$X.Load.
deflect<-ring$X.Deflection.
lm6_1<-lm(deflect ~ load + I(load^2) + I(load^3) + I(load^4))
summary(lm6_1)
help(cor)
cor(load, I(load^2))
cor(load, I(load^3))
cor(load, I(load^4))
cor(I(load^3) I(load^4))
cor(I(load^3),I(load^4))
summary(lm(deflect~load))
cor(I(load^2),I(load^3))
cor(I(load^2),I(load^4))
cor(I(load^3),I(load^4))
cor(I(load^4),I(load^4))
# Question 7: Mann-Whitney
MA<-c(79.98, 80.04, 80.02)
MB<-c(80.02,79.94, 79.98)
t.test(MA, MB, alternative = "two.sided", var.equal = TRUE)
# Question 7: Mann-Whitney
MA<-read.csv("./hwdata/hw7-methodAB.txt", header=F, sep=" ")
# Question 7: Mann-Whitney
MA<-read.csv("./hwdata/hw7-methodAB.txt", header=F)
# Question 7: Mann-Whitney
MA<-read.csv("./hwdata/hw7-methodAB.txt", header=F)
# Question 7: Mann-Whitney
MA<-read.csv("./hwdata/hw7-methodAB.txt", header=F)
MA
# Question 7: Mann-Whitney
MA<-read.csv("./hwdata/hw7-methodA.txt", header=F)
# Question 7: Mann-Whitney
MA<-read.csv("./hwdata/hw7-methodA.txt",)
# Question 7: Mann-Whitney
MA<-read.csv("./hwdata/hw7-methodA.txt")
t.test(MA, MB, alternative = "two.sided", var.equal = TRUE)
MB<-read.csv("./hwdata/hw7-methodB.txt")
t.test(MA, MB, alternative = "two.sided", var.equal = TRUE)
# Question 7: Mann-Whitney
MA<-read.csv("./hwdata/hw7-methodA.txt")
MB<-read.csv("./hwdata/hw7-methodB.txt")
t.test(MA, MB, alternative = "two.sided", var.equal = TRUE)
# Question 7: Mann-Whitney
MA<-read.csv("./hwdata/hw7-methodA.txt")
MB<-read.csv("./hwdata/hw7-methodB.txt")
t.test(MA, MB, alternative = "two.sided", var.equal = TRUE)
MB<-read.csv("./hwdata/hw7-methodB.txt")
t.test(MA, MB, alternative = "two.sided", var.equal = TRUE)
MB<-read.csv("./hwdata/hw7-methodB.txt")
t.test(MA, MB, alternative = "two.sided", var.equal = TRUE)
wilcox.test(MA,MB)
wilcox.test(MA$methodA,MB$methodB)
help(wilcox.test())
help(wilcox.test
)
wilcox.test(MA$methodA,MB$methodB, paired = FALSE)
XMA<-c(MA$methodA)
wilcox.test(XMA, XMB, paired = FALSE)
wilcox.test(XMA, XMA, paired = FALSE)
wilcox.test(MA$methodA, MB$methodB)
# Question 7: Mann-Whitney
MA<-read.csv("./hwdata/hw7-methodA.txt")
MB<-read.csv("./hwdata/hw7-methodB.txt")
t.test(MA, MB, alternative = "two.sided", var.equal = TRUE)
wilcox.test(MA$methodA, MB$methodB)
MB<-read.csv("./hwdata/hw7-methodB.txt")
t.test(MA, MB, alternative = "two.sided", var.equal = TRUE)
wilcox.test(MA$methodA, MB$methodB)
MB<-read.csv("./hwdata/hw7-methodB.txt")
t.test(MA, MB, alternative = "two.sided", var.equal = TRUE)
wilcox.test(MA$methodA, MB$methodB)
xbar<-mean(load)
mean<-mean(load)
lm6_2<-lm(deflect ~ I(load-mean) + I(load^2-mean) + I(load^3-mean) + I(load^4-mean))
summary(lm6_2)
lm6_2<-lm(deflect ~ I(load-mean) + I((load-mean)^2) + I((load-mean)^3) + I((load-mean)^4))
summary(lm6_2)
corr((load-mean), (load-mean)^2)
cor((load-mean), (load-mean)^2)
cor((load-mean), (load-mean)^3)
cor((load-mean), (load-mean)^)
cor((load-mean), (load-mean)^4)
cor((load-mean)^2, (load-mean)^3)
cor((load-mean)^2, (load-mean)^4)
cor((load-mean)^3, (load-mean)^4)
cor((load-mean), -(load-mean)^2)
cor(-(load-mean), (load-mean)^2)
